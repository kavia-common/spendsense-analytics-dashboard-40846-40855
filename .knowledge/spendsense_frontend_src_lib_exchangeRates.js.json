{"is_source_file": true, "format": "JavaScript", "description": "This file provides functionality for fetching, caching, and converting exchange rates between currencies. It includes in-memory caching, API interaction with ETag support, and utility functions for normalizing currency codes and performing conversions.", "external_files": ["./logger"], "external_methods": ["logDebug", "logInfo", "logWarn"], "published": ["getRates", "convertAmount", "getConverter"], "classes": [], "methods": [{"name": "normalizeCurrency(code)", "description": "Trims and converts currency code to uppercase for consistency.", "scope": "", "scopeKind": ""}, {"name": "getProviderConfig()", "description": "Obtains API URL and key from environment variables or defaults.", "scope": "", "scopeKind": ""}, {"name": "buildLatestUrl(baseCurrency)", "description": "Constructs the API URL with query parameters for a given base currency.", "scope": "", "scopeKind": ""}, {"name": "parseRatesResponse(payload, requestedBase)", "description": "Parses API response JSON into a standardized format with base, rates, and date.", "scope": "", "scopeKind": ""}, {"name": "getCachedEntry(baseCurrency)", "description": "Retrieves cached exchange rate data for a given base currency.", "scope": "", "scopeKind": ""}, {"name": "setCachedEntry(baseCurrency, entry)", "description": "Stores exchange rate data in cache for a given base currency.", "scope": "", "scopeKind": ""}, {"name": "isFresh(entry)", "description": "Checks if cached data is less than 12 hours old.", "scope": "", "scopeKind": ""}, {"name": "getRates(baseCurrency)", "description": "Fetches latest exchange rates from API, with ETag support and caching.", "scope": "", "scopeKind": ""}, {"name": "convertAmount(amount, fromCurrency, toCurrency, rates)", "description": "Converts an amount between two currencies using provided rates.", "scope": "", "scopeKind": ""}, {"name": "getConverter(toCurrency)", "description": "Provides a conversion function with background cache refresh and status meta.", "scope": "", "scopeKind": ""}], "calls": ["buildLatestUrl", "parseRatesResponse", "getCachedEntry", "setCachedEntry", "isFresh", "getRates"], "search-terms": ["exchangeRates", "currency conversion", "ETag cache", "in-memory cache", "getRates", "convertAmount", "getConverter"], "state": 2, "file_id": 36, "knowledge_revision": 106, "git_revision": "", "ctags": [{"_type": "tag", "name": "Accept", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^    Accept: \"application\\/json\",$/", "language": "JavaScript", "kind": "property", "scope": "getRates.headers", "scopeKind": "class"}, {"_type": "tag", "name": "TWELVE_HOURS_MS", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^const TWELVE_HOURS_MS = 12 * 60 * 60 * 1000;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^      base: parsed.base,$/", "language": "JavaScript", "kind": "property", "scope": "getRates.entry", "scopeKind": "class"}, {"_type": "tag", "name": "buildLatestUrl", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function buildLatestUrl(baseCurrency) {$/", "language": "JavaScript", "kind": "function", "signature": "(baseCurrency)"}, {"_type": "tag", "name": "cacheByBase", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^const cacheByBase = new Map();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "convertAmount", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^export function convertAmount(amount, fromCurrency, toCurrency, rates) {$/", "language": "JavaScript", "kind": "function", "signature": "(amount, fromCurrency, toCurrency, rates)"}, {"_type": "tag", "name": "date", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^      date: parsed.date,$/", "language": "JavaScript", "kind": "property", "scope": "getRates.entry", "scopeKind": "class"}, {"_type": "tag", "name": "entry", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^    const entry = {$/", "language": "JavaScript", "kind": "class", "scope": "getRates", "scopeKind": "class"}, {"_type": "tag", "name": "etag", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^      etag,$/", "language": "JavaScript", "kind": "field", "scope": "getRates.entry", "scopeKind": "class"}, {"_type": "tag", "name": "getCachedEntry", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function getCachedEntry(baseCurrency) {$/", "language": "JavaScript", "kind": "function", "signature": "(baseCurrency)"}, {"_type": "tag", "name": "getConverter", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^export function getConverter(toCurrency) {$/", "language": "JavaScript", "kind": "function", "signature": "(toCurrency)"}, {"_type": "tag", "name": "getProviderConfig", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function getProviderConfig() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getRates", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^export async function getRates(baseCurrency) {$/", "language": "JavaScript", "kind": "function", "signature": "(baseCurrency)"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^  const headers = {$/", "language": "JavaScript", "kind": "class", "scope": "getRates", "scopeKind": "class"}, {"_type": "tag", "name": "isFresh", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function isFresh(entry) {$/", "language": "JavaScript", "kind": "function", "signature": "(entry)"}, {"_type": "tag", "name": "normalizeCurrency", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function normalizeCurrency(code) {$/", "language": "JavaScript", "kind": "function", "signature": "(code)"}, {"_type": "tag", "name": "parseRatesResponse", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function parseRatesResponse(payload, requestedBase) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload, requestedBase)"}, {"_type": "tag", "name": "rates", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^      rates: parsed.rates,$/", "language": "JavaScript", "kind": "property", "scope": "getRates.entry", "scopeKind": "class"}, {"_type": "tag", "name": "setCachedEntry", "path": "/home/kavia/workspace/code-generation/spendsense-analytics-dashboard-40846-40855/spendsense_frontend/src/lib/exchangeRates.js", "pattern": "/^function setCachedEntry(baseCurrency, entry) {$/", "language": "JavaScript", "kind": "function", "signature": "(baseCurrency, entry)"}], "hash": "5cf22e93047faee27aefe0fb8d116aa0", "format-version": 4, "code-base-name": "spendsense_frontend", "filename": "spendsense_frontend/src/lib/exchangeRates.js", "fields": [{"name": "Accept: \"application\\/json\",", "scope": "getRates.headers", "scopeKind": "class", "description": "unavailable"}, {"name": "base: parsed.base,", "scope": "getRates.entry", "scopeKind": "class", "description": "unavailable"}, {"name": "date: parsed.date,", "scope": "getRates.entry", "scopeKind": "class", "description": "unavailable"}, {"name": "etag,", "scope": "getRates.entry", "scopeKind": "class", "description": "unavailable"}, {"name": "rates: parsed.rates,", "scope": "getRates.entry", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"106": ""}]}